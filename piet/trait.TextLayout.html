<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="API documentation for the Rust `TextLayout` trait in crate `piet`."><meta name="keywords" content="rust, rustlang, rust-lang, TextLayout"><title>piet::TextLayout - Rust</title><link rel="stylesheet" type="text/css" href="../normalize.css"><link rel="stylesheet" type="text/css" href="../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../dark.css"><link rel="stylesheet" type="text/css" href="../light.css" id="themeStyle"><script src="../storage.js"></script><noscript><link rel="stylesheet" href="../noscript.css"></noscript><link rel="shortcut icon" href="../favicon.ico"><style type="text/css">#crate-search{background-image:url("../down-arrow.svg");}</style></head><body class="rustdoc trait"><!--[if lte IE 8]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="sidebar"><div class="sidebar-menu">&#9776;</div><a href='../piet/index.html'><div class='logo-container'><img src='../rust-logo.png' alt='logo'></div></a><p class='location'>Trait TextLayout</p><div class="sidebar-elems"><div class="block items"><a class="sidebar-title" href="#required-methods">Required Methods</a><div class="sidebar-links"><a href="#tymethod.hit_test_point">hit_test_point</a><a href="#tymethod.hit_test_text_position">hit_test_text_position</a><a href="#tymethod.line_count">line_count</a><a href="#tymethod.line_metric">line_metric</a><a href="#tymethod.line_text">line_text</a><a href="#tymethod.update_width">update_width</a><a href="#tymethod.width">width</a></div><a class="sidebar-title" href="#implementors">Implementors</a></div><p class='location'><a href='index.html'>piet</a></p><script>window.sidebarCurrent = {name: 'TextLayout', ty: 'trait', relpath: ''};</script><script defer src="sidebar-items.js"></script></div></nav><div class="theme-picker"><button id="theme-picker" aria-label="Pick another theme!"><img src="../brush.svg" width="18" alt="Pick another theme!"></button><div id="theme-choices"></div></div><script src="../theme.js"></script><nav class="sub"><form class="search-form"><div class="search-container"><div><select id="crate-search"><option value="All crates">All crates</option></select><input class="search-input" name="search" disabled autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"></div><a id="settings-menu" href="../settings.html"><img src="../wheel.svg" width="18" alt="Change settings"></a></div></form></nav><section id="main" class="content"><h1 class='fqn'><span class='out-of-band'><span id='render-detail'><a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class='inner'>&#x2212;</span>]</a></span><a class='srclink' href='../src/piet/text.rs.html#75-141' title='goto source code'>[src]</a></span><span class='in-band'>Trait <a href='index.html'>piet</a>::<wbr><a class="trait" href=''>TextLayout</a></span></h1><div class="docblock type-decl hidden-by-usual-hider"><pre class='rust trait'>pub trait TextLayout: <a class="trait" href="https://doc.rust-lang.org/nightly/core/clone/trait.Clone.html" title="trait core::clone::Clone">Clone</a> {
    fn <a href='#tymethod.width' class='fnname'>width</a>(&amp;self) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.f64.html">f64</a>;
<div class='item-spacer'></div>    fn <a href='#tymethod.update_width' class='fnname'>update_width</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;mut self, <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new_width: impl <a class="trait" href="https://doc.rust-lang.org/nightly/core/convert/trait.Into.html" title="trait core::convert::Into">Into</a>&lt;<a class="enum" href="https://doc.rust-lang.org/nightly/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.f64.html">f64</a>&gt;&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;) -&gt; <a class="enum" href="https://doc.rust-lang.org/nightly/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.unit.html">()</a>, <a class="enum" href="../piet/enum.Error.html" title="enum piet::Error">Error</a>&gt;;
<div class='item-spacer'></div>    fn <a href='#tymethod.line_text' class='fnname'>line_text</a>(&amp;self, line_number: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>) -&gt; <a class="enum" href="https://doc.rust-lang.org/nightly/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;&amp;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.str.html">str</a>&gt;;
<div class='item-spacer'></div>    fn <a href='#tymethod.line_metric' class='fnname'>line_metric</a>(&amp;self, line_number: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>) -&gt; <a class="enum" href="https://doc.rust-lang.org/nightly/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;<a class="struct" href="../piet/struct.LineMetric.html" title="struct piet::LineMetric">LineMetric</a>&gt;;
<div class='item-spacer'></div>    fn <a href='#tymethod.line_count' class='fnname'>line_count</a>(&amp;self) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>;
<div class='item-spacer'></div>    fn <a href='#tymethod.hit_test_point' class='fnname'>hit_test_point</a>(&amp;self, point: <a class="struct" href="../kurbo/point/struct.Point.html" title="struct kurbo::point::Point">Point</a>) -&gt; <a class="struct" href="../piet/struct.HitTestPoint.html" title="struct piet::HitTestPoint">HitTestPoint</a>;
<div class='item-spacer'></div>    fn <a href='#tymethod.hit_test_text_position' class='fnname'>hit_test_text_position</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;self, <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text_position: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a><br>&nbsp;&nbsp;&nbsp;&nbsp;) -&gt; <a class="enum" href="https://doc.rust-lang.org/nightly/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;<a class="struct" href="../piet/struct.HitTestTextPosition.html" title="struct piet::HitTestTextPosition">HitTestTextPosition</a>&gt;;
}</pre></div><div class='docblock'><h1 id="text-layout" class="section-header"><a href="#text-layout">Text Layout</a></h1><h2 id="line-breaks" class="section-header"><a href="#line-breaks">Line Breaks</a></h2>
<p>A text layout may be broken into multiple lines in order to fit within a given width. Line breaking is generally done
between words (whitespace-separated).</p>
<p>When resizing the width of the text layout, calling <a href="trait.TextLayout.html#tymethod.update_width"><code>update_width</code></a> on the text layout will
recalculate line breaks and modify in-place.</p>
<p>A line's text and <a href="struct.LineMetric.html"><code>LineMetric</code></a>s can be accessed line-by-line by 0-indexed line number.</p>
<p>Fields on ['LineMetric`] include:</p>
<ul>
<li>line start offset from text layout beginning (in UTF-8 code units)</li>
<li>line end offset from text layout beginning (in UTF-8 code units)</li>
<li>line trailing whitespace (in UTF-8 code units)</li>
<li>line's baseline, distance of the baseline from the top of the line</li>
<li>line height</li>
<li>cumulative line height (includes previous line heights)</li>
</ul>
<p>The trailing whitespace distinction is important. Lines are broken at the grapheme boundary after
whitespace, but that whitepace is not necessarily rendered since it's just the trailing
whitepace at the end of a line. Keeping the trailing whitespace data available allows API
consumers to determine their own trailing whitespace strategy.</p>
<h2 id="text-position" class="section-header"><a href="#text-position">Text Position</a></h2>
<p>A text position is the offset in the underlying string, defined in utf-8 code units, as is standard for Rust strings.</p>
<p>However, text position is also related to valid cursor positions. Therefore:</p>
<ul>
<li>The beginning of a line has text position <code>0</code>.</li>
<li>The end of a line is a valid text position. e.g. <code>text.len()</code> is a valid text position.</li>
<li>If the text position is not at a code point or grapheme boundary, undesirable behavior may
occur.</li>
</ul>
</div>
            <h2 id='required-methods' class='small-section-header'>Required methods<a href='#required-methods' class='anchor'></a></h2><div class='methods'><h3 id='tymethod.width' class='method'><code id='width.v'>fn <a href='#tymethod.width' class='fnname'>width</a>(&amp;self) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.f64.html">f64</a></code></h3><div class='docblock'><p>Measure the advance width of the text.</p>
</div><h3 id='tymethod.update_width' class='method'><code id='update_width.v'>fn <a href='#tymethod.update_width' class='fnname'>update_width</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;&amp;mut self, <br>&nbsp;&nbsp;&nbsp;&nbsp;new_width: impl <a class="trait" href="https://doc.rust-lang.org/nightly/core/convert/trait.Into.html" title="trait core::convert::Into">Into</a>&lt;<a class="enum" href="https://doc.rust-lang.org/nightly/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.f64.html">f64</a>&gt;&gt;<br>) -&gt; <a class="enum" href="https://doc.rust-lang.org/nightly/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.unit.html">()</a>, <a class="enum" href="../piet/enum.Error.html" title="enum piet::Error">Error</a>&gt;</code></h3><div class='docblock'><p>Change the width of this <code>TextLayout</code>.</p>
<p>This may be an <code>f64</code>, or <code>None</code> if this layout is not constrained;
<code>None</code> is equivalent to <code>std::f64::INFINITY</code>.</p>
</div><h3 id='tymethod.line_text' class='method'><code id='line_text.v'>fn <a href='#tymethod.line_text' class='fnname'>line_text</a>(&amp;self, line_number: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>) -&gt; <a class="enum" href="https://doc.rust-lang.org/nightly/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;&amp;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.str.html">str</a>&gt;</code></h3><div class='docblock'><p>Given a line number, return a reference to that line's underlying string.</p>
</div><h3 id='tymethod.line_metric' class='method'><code id='line_metric.v'>fn <a href='#tymethod.line_metric' class='fnname'>line_metric</a>(&amp;self, line_number: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>) -&gt; <a class="enum" href="https://doc.rust-lang.org/nightly/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;<a class="struct" href="../piet/struct.LineMetric.html" title="struct piet::LineMetric">LineMetric</a>&gt;</code></h3><div class='docblock'><p>Given a line number, return a reference to that line's metrics.</p>
</div><h3 id='tymethod.line_count' class='method'><code id='line_count.v'>fn <a href='#tymethod.line_count' class='fnname'>line_count</a>(&amp;self) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a></code></h3><div class='docblock'><p>Returns total number of lines in the text layout.</p>
</div><h3 id='tymethod.hit_test_point' class='method'><code id='hit_test_point.v'>fn <a href='#tymethod.hit_test_point' class='fnname'>hit_test_point</a>(&amp;self, point: <a class="struct" href="../kurbo/point/struct.Point.html" title="struct kurbo::point::Point">Point</a>) -&gt; <a class="struct" href="../piet/struct.HitTestPoint.html" title="struct piet::HitTestPoint">HitTestPoint</a></code></h3><div class='docblock'><p>Given a <code>Point</code>, determine the corresponding text position.</p>
<h2 id="return-value" class="section-header"><a href="#return-value">Return value:</a></h2>
<p>Returns a <a href="struct.HitTestPoint.html"><code>HitTestPoint</code></a> describing the results of the test.</p>
<p><a href="struct.HitTestPoint.html"><code>HitTestPoint</code></a> field <code>is_inside</code> is true if the tested point falls within the bounds of the text, <code>false</code> otherwise.</p>
<p><a href="struct.HitTestPoint.html"><code>HitTestPoint</code></a> field <code>metrics</code> is a <a href="struct.HitTestMetrics.html"><code>HitTestMetrics</code></a> struct. <a href="struct.HitTestMetrics.html"><code>HitTestMetrics</code></a> field <code>text_position</code> is the text
position closest to the tested point.</p>
<h2 id="notes" class="section-header"><a href="#notes">Notes:</a></h2>
<p>Some text position will always be returned; if the tested point is inside, it returns the appropriate text
position; if it's outside, it will return the nearest text position (either <code>0</code> or <code>text.len()</code>).</p>
<p>For more on text positions, see docs for the <a href="../piet/trait.TextLayout.html"><code>TextLayout</code></a>
trait.</p>
</div><h3 id='tymethod.hit_test_text_position' class='method'><code id='hit_test_text_position.v'>fn <a href='#tymethod.hit_test_text_position' class='fnname'>hit_test_text_position</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;&amp;self, <br>&nbsp;&nbsp;&nbsp;&nbsp;text_position: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a><br>) -&gt; <a class="enum" href="https://doc.rust-lang.org/nightly/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;<a class="struct" href="../piet/struct.HitTestTextPosition.html" title="struct piet::HitTestTextPosition">HitTestTextPosition</a>&gt;</code></h3><div class='docblock'><p>Given a text position, determine the corresponding pixel location.
(currently consider the text layout just one line)</p>
<h2 id="return-value-1" class="section-header"><a href="#return-value-1">Return value:</a></h2>
<p>Returns a <a href="struct.HitTestTextPosition.html"><code>HitTestTextPosition</code></a> describing the results of the test.</p>
<p><a href="struct.HitTestTextPosition.html"><code>HitTestTextPosition</code></a> field <code>point</code> is the point offset of the boundary of the
grapheme cluster that the text position is a part of.</p>
<p><a href="struct.HitTestTextPosition.html"><code>HitTestTextPosition</code></a> field <code>metrics</code> is a <a href="struct.HitTestMetrics.html"><code>HitTestMetrics</code></a> struct. <a href="struct.HitTestMetrics.html"><code>HitTestMetrics</code></a> field <code>text_position</code> is the original text position (unless out of bounds).</p>
<h2 id="notes-1" class="section-header"><a href="#notes-1">Notes:</a></h2>
<p>In directwrite, if a text position is not at code point boundary, this method will panic.
Cairo and web are more lenient and may not panic.</p>
<p>For text position that is greater than <code>text.len()</code>, web/cairo will return the
<a href="struct.HitTestTextPosition.html"><code>HitTestTextPosition</code></a> as if <code>text_position == text.len()</code>. In directwrite, the method will
panic, as the text position is out of bounds.</p>
<p>For more on text positions, see docs for the <a href="../piet/trait.TextLayout.html"><code>TextLayout</code></a>
trait.</p>
</div></div><span class='loading-content'>Loading content...</span>
            <h2 id='implementors' class='small-section-header'>Implementors<a href='#implementors' class='anchor'></a></h2><div class='item-list' id='implementors-list'></div><span class='loading-content'>Loading content...</span><script type="text/javascript" src="../implementors/piet/trait.TextLayout.js" async></script></section><section id="search" class="content hidden"></section><section class="footer"></section><script>window.rootPath = "../";window.currentCrate = "piet";</script><script src="../aliases.js"></script><script src="../main.js"></script><script defer src="../search-index.js"></script></body></html>